var options={cstrName:"init",forceCstr:true,nameBlacklist:"_blacklist",deleteBlacklist:true};var debugPlugin=function(e,t,n){console.log("["+e+"] - "+t);console.log("	type: ",n._type);var n=n.prototype||n;for(var e in n){if(n.hasOwnProperty(e)){var r=n[e];var i=typeof r;switch(i){case"function":i=r.toString().replace(/\n/g,"");i=i.replace(/\s+/g," ");break;case"object":i=JSON.stringify(r);break;default:i=r;break}console.log("	property: ["+e+"]:		["+i+"] -> ("+typeof r+")")}}};var Embryo=function(){this[options.cstrName]&&this[options.cstrName].apply(this,arguments)};Embryo.plugins=[];Embryo.extend=function(e){var t=e[options.cstrName]||null;if(options.forceCstr&&!t){if(!t){throw Error("No constructor function found.")}}if(t&&typeof t!=="function"){throw Error("Constructor function invalid.")}var n=this;var r=function(){return n.apply(this,arguments)};r.extend=n.extend;var i=function(){};i.prototype=n.prototype;r.prototype=new i;for(var s in this.plugins){if(this.plugins.hasOwnProperty(s)){var o=this.plugins[s];var u=o.isDebug()?debugPlugin:null;e=o.exec(e,u,r)}}for(var a in e){if(a==options.nameBlacklist&&options.deleteBlacklist){continue}r.prototype[a]=e[a]}return r};Embryo.configure=function(e){for(var t in e){if(e.hasOwnProperty(t)){options[t]=e[t]}}};Embryo.use=function(e,t){e.configure(options);e.setDebug(t);Embryo.plugins[e.name]=e};Embryo.configure();Embryo.Plugin=Embryo.extend({_type:"Plugin",name:"Plugin",options:null,init:function(e){this.setDebug(e)},configure:function(e){for(var t in e){if(e.hasOwnProperty(t)){this.options[t]=e[t]}}},isBlacklisted:function(e){var t=e["_blacklist"];if(!t){return false}for(var n=0;n<t.length;n++){var r=t[n];if(r==this.name||r=="*"){return true}}return false},isDebug:function(){return this.debug},setDebug:function(e){this.debug=e||false},getName:function(){return this.name}});var Attribute=Embryo.Plugin.extend({name:"Attribute",options:{getPrefix:"get",setPrefix:"set",camelize:false},init:function(){},exec:function(e,t,n){if(this.isBlacklisted(e)){t&&console.log("["+this.name+"] - SKIPPED");return e}t&&t(this.name,"BEFORE",e);for(var r in e){if(e.hasOwnProperty(r)){var i=e[r];if(r!="_type"&&typeof i!=="function"){var s=this.options.camelize?this.camelize(r):r;var o=this.options.getPrefix+s;this.defineGetter(e,o,r);s=this.options.camelize?this.camelize(r):r;o=this.options.setPrefix+s;this.defineSetter(e,o,r)}}}t&&t(this.name,"AFTER",e);return e},defineGetter:function(e,t,n){e[t]=function(){return this[n]}},defineSetter:function(e,t,n){e[t]=function(e){this[n]=e}},camelize:function(e){e=e.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);return e}});var BeforeAfter=Embryo.Plugin.extend({name:"BeforeAfter",options:{beforePrefix:"-",afterPrefix:"+",hiddenPrefix:"_pm_"},init:function(){},exec:function(e,t,n){if(this.isBlacklisted(e)){t&&console.log("["+this.name+"] - SKIPPED");return e}t&&t(this.name,"BEFORE",e);var r={};var i=this.options.beforePrefix;var s=this.options.afterPrefix;for(var o in e){if(e.hasOwnProperty(o)){var u=e[o];var a="";var f=null;if(typeof u=="function"){if(o.indexOf(s)>-1){a=o.replace(s,"");f=r[a];if(!f){f=r[a]={before:false,after:false}}f.after=true}else if(o.indexOf(i)>-1){a=o.replace(i,"");f=r[a];if(!f){f=r[a]={before:false,after:false}}f.before=true}}}}for(var l in r){if(r.hasOwnProperty(l)){var c=r[l];this.defineMethod(e,l,c.before,c.after)}}t&&t(this.name,"AFTER",e);return e},defineMethod:function(e,t,n,r){if(!e[t]){throw new Error("method "+t+" not found.")}var i=this.options.hiddenPrefix+t;var s=this.options.beforePrefix+t;var o=this.options.afterPrefix+t;e[i]=e[t];if(n&&r){e[t]=function(){this[s]();this[i]();this[o]()}}else if(n){e[t]=function(){this[s]();this[i]()}}else{e[t]=function(){this[i]();this[o]()}}}});var Extend=Embryo.Plugin.extend({name:"Extend",options:{nameType:"_type",nameProperties:"properties",deleteProperties:true,forceTyping:true},init:function(){},exec:function(e,t,n){if(this.isBlacklisted(e)){t&&console.log("["+this.name+"] - SKIPPED");return e}t&&t(this.name,"BEFORE",e);if(this.options.forceTyping&&!e[this.options.nameType]){e[this.options.nameType]=this.options.typeDefault}var r=e[this.options.nameProperties]||null;if(r){if(typeof r!=="object"){throw Error("properties object invalid.")}for(var i in r){if(r.hasOwnProperty(i)){e[i]=r[i]}}}if(this.options.deleteProperties){delete e[this.options.nameProperties]}t&&t(this.name,"AFTER",e);return e}});var Surcharge=Embryo.Plugin.extend({name:"Surcharge",options:{suffix:"|",hiddenPrefix:"_pm_"},methods:[],init:function(){},exec:function(e,t,n){if(this.isBlacklisted(e)){t&&console.log("["+this.name+"] - SKIPPED");return e}t&&t(this.name,"BEFORE",e);var r=this.options.suffix;this.methods=[];for(var i in e){if(e.hasOwnProperty(i)){if(typeof e[i]=="function"){if(i.indexOf(r)>-1){parts=i.split(r);var s=parts[0];if(s){if(!this.isMethodExist(s)){this.methods.push(s)}}}}}}for(var o=0;o<this.methods.length;o++){this.defineMethod(e,this.methods[o])}t&&t(this.name,"AFTER",e);return e},isMethodExist:function(e){for(var t=0;t<this.methods.length;t++){if(this.methods[t]==e){return true}}return false},defineMethod:function(e,t){var n=this.options.hiddenPrefix;var r=n+t;var i=this.options.suffix;e[r]=e[t];e[t]=function(){var e=t+i+arguments.length;var r=this[e];if(!r){e=n+t;r=this[e]}if(!r){throw new Error('method "'+t+'" not defined.')}r()}}});var extendPlugin=new Extend;extendPlugin.configure({nameType:"_type",typeDefault:"Embryo",forceTyping:true,nameProperties:"properties",deleteProperties:true});var attributePlugin=new Attribute;attributePlugin.configure({getPrefix:"get",setPrefix:"set",camelize:true});var beforeAfterPlugin=new BeforeAfter;beforeAfterPlugin.configure({beforePrefix:"-",afterPrefix:"+",hiddenPrefix:"_bah_"});var surchargePlugin=new Surcharge;surchargePlugin.configure({suffix:"|",hiddenPrefix:"_pm_"});Embryo.configure({cstrName:"init",forceCstr:true,nameBlacklist:"_blacklist",deleteBlacklist:true});Embryo.use(extendPlugin,false);Embryo.use(attributePlugin,false);Embryo.use(beforeAfterPlugin,false);Embryo.use(surchargePlugin,false)